{"version":3,"file":"scripts/editor.c95b8a66.js","mappings":"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","sources":["webpack:///./src/common/scripts/language/vyxal.grammar","webpack:///./src/common/scripts/language/vyxal.ts","webpack:///./src/common/scripts/language/vyxal-lit.grammar","webpack:///./src/common/scripts/language/vyxal-lit.ts","webpack:///./src/latest/scripts/language/common.ts","webpack:///./src/latest/scripts/language/sbcs/autocomplete.ts","webpack:///./src/latest/scripts/language/sbcs/bracket-matching.ts","webpack:///./src/latest/scripts/language/sbcs/compression.ts","webpack:///./src/latest/scripts/language/sbcs/tooltips.ts","webpack:///./src/latest/scripts/language/literate/autocomplete.ts","webpack:///./src/latest/scripts/ui/Editor.tsx"],"sourcesContent":["// This file was generated by lezer-generator. You probably shouldn't edit it.\nimport {LRParser} from \"@lezer/lr\"\nexport const __parser = LRParser.deserialize({\n  version: 14,\n  states: \"!QOVQPOOOOQO'#Ch'#ChOOQO'#Cg'#CgOOQO'#Ck'#CkOOQO'#C_'#C_OOQO'#Cs'#CsQVQPOOOOQO-E6q-E6q\",\n  stateData: \"!a~OPOS~OSSOTSOUSOVSOWSOXSOYSO]PO^QO`ROaRObROcSOdSOeSOfSOjPO~OPf~\",\n  goto: \"{hPPPiPPPPPPPmqPPmPPPPPPPuTTOUTSOUTQOUQUORVU\",\n  nodeNames: \"⚠ Space Program Statement Digraph SyntaxTrigraph StructureOpen StructureClose ListStuff ModifierChar VariableThing Number NumberDecimal NumberPart TwoCharNumber AnyString String SingleCharString TwoCharString Branch ContextIndex Comment Element\",\n  maxTerm: 26,\n  skippedNodes: [0,1],\n  repeatNodeCount: 1,\n  tokenData: \"4]~R#^OX'}X^(S^p'}pq(Sqr'}rs)nst+ttw'}wx/kxy/Ryz0Uz!O'}!O!P0Z!P!Q'}!Q!R0`!R![0e![!}'}!}#O/R#O#P'}#P#Q0U#Q#_'}#_#`0m#`#o'}#o#p/R#p#q1R#q#r0U#r#s1W#s#y'}#y#z(S#z$f'}$f$g(S$g$n'}$n$o1W$o${'}${$|/R$|%V'}%V%W1W%W%v'}%v%w0m%w&b'}&b&c0m&c){'}){)|/R)|5a'}5a5b/R5b5s'}5s5t/R5t#3['}#3[#3]1]#3]#3h'}#3h#3i2q#3i#=v'}#=v#=w1W#=w#BY'}#BY#BZ(S#BZ#D['}#D[#D]1W#D]$@v'}$@v$@w1W$@w$IS'}$IS$I_(S$I_$Ip'}$Is$I|'}$I|$JO(S$JO$JT'}$JT$JU(S$JU$KS'}$KS$KT1W$KT$KV'}$KV$KW(S$KW$L}'}$L}$MO/R$MO%&`'}%&`%&a0m%&a%'P'}%'P%'Q1W%'Q%'R1W%'R%'f'}%'f%'g1W%'g%-w'}%-w%-x0U%-x%.l'}%.l%.m1W%.m%.n'}%.n%.o/R%.o%.q'}%.q%.r1W%.r%.t'}%.t%.u/R%.u%.v0U%.v%3x'}%3x%3y1W%3y%3z1W%3z%3{1W%3{%3|1W%3|%:h'}%:h%:i1W%:i%Fl'}%Fl%Fm1W%Fm&&j'}&&j&&k1W&&k&FU'}&FU&FV(S&FV;'S'};'S;=`4V<%lO'}~(SOf~~(ZYP~f~X^(ypq(y#y#z(y$f$g(y#BY#BZ(y$IS$I_(y$I|$JO(y$JT$JU(y$KV$KW(y&FU&FV(y~)OYP~X^(ypq(y#y#z(y$f$g(y#BY#BZ(y$IS$I_(y$I|$JO(y$JT$JU(y$KV$KW(y&FU&FV(y~)qZOr)nrs*ds#O)n#O#P*i#P$Ip)n$Ip$Iq*d$Iq$Ir*d$Ir$Is*d$Is;'S)n;'S;=`+n<%lO)n~*iO`~~*lRO;'S)n;'S;=`*u;=`O)n~*x[Or)nrs*ds#O)n#O#P*i#P$Ip)n$Ip$Iq*d$Iq$Ir*d$Ir$Is*d$Is;'S)n;'S;=`+n;=`<%l)n<%lO)n~+qP;=`<%l)n~+weOq-Yrs-Yst-_tu-vu![-Y![!]._!]!_-Y!_!`-v!`!a-v!a!b-Y!c!}-Y!}#O.|#O#P-Y#P#Q.|#Q#o-Y#o#p/R#p$j-Y$j$k/W$k;'S-Y;'S;=`/e<%lO-Y~-_OS~~-dSe~OY-_Z;'S-_;'S;=`-p<%lO-_~-sP;=`<%l-_~-yP!c!}-|~.RSY~!Q![-|!c!}-|#R#S-|#T#o-|~.bTO!}.q!}#O-v#O;'S.q;'S;=`.v<%lO.q~.vOT~~.yP;=`<%l.q~/ROW~~/WOU~~/]PS~!Q![/`~/eOd~~/hP;=`<%l-Y~/nRO;'S/w;'S;=`/|;=`O/w~/|Oa~~0RPa~;=`<%l/w~0ZOV~~0`Oj~~0eO]~~0jP]~!Q![0e~0pRO;'S-Y;'S;=`0y;=`O-Y~1OPS~;=`<%l-Y~1WOc~~1]OX~~1`RO;'S1i;'S;=`2S;=`O1i~1lRO;'S1u;'S;=`1z;=`O1u~1zO^~~2PP^~;=`<%l1u~2VSO;'S1u;'S;=`1z;=`<%l2c<%lO1u~2hR^~O;'S1u;'S;=`1z;=`O1u~2tRO;'S2};'S;=`3h;=`O2}~3QRO;'S3Z;'S;=`3`;=`O3Z~3`Ob~~3ePb~;=`<%l3Z~3kSO;'S3Z;'S;=`3`;=`<%l3w<%lO3Z~3|Rb~O;'S3Z;'S;=`3`;=`O3Z~4YP;=`<%l'}\",\n  tokenizers: [0],\n  topRules: {\"Program\":[0,2]},\n  tokenPrec: 60\n})\n\nexport default __parser\n// This file was generated by lezer-generator. You probably shouldn't edit it.\nexport const\n  Space = 1,\n  Program = 2,\n  Statement = 3,\n  Digraph = 4,\n  SyntaxTrigraph = 5,\n  StructureOpen = 6,\n  StructureClose = 7,\n  ListStuff = 8,\n  ModifierChar = 9,\n  VariableThing = 10,\n  Number = 11,\n  NumberDecimal = 12,\n  NumberPart = 13,\n  TwoCharNumber = 14,\n  AnyString = 15,\n  String = 16,\n  SingleCharString = 17,\n  TwoCharString = 18,\n  Branch = 19,\n  ContextIndex = 20,\n  Comment = 21,\n  Element = 22\n","import { LRLanguage } from \"@codemirror/language\";\nimport { styleTags, tags } from \"@lezer/highlight\";\nimport parser from \"./vyxal.grammar\";\nexport const vyxalLanguage = LRLanguage.define({\n    parser: parser.configure({\n        props: [\n            styleTags({\n                Digraph: tags.function(tags.propertyName),\n                SyntaxTrigraph: tags.operator,\n                StructureOpen: tags.bracket,\n                StructureClose: tags.bracket,\n                ListStuff: tags.bracket,\n                Modifier: tags.moduleKeyword,\n                VariableThing: tags.variableName,\n                String: tags.string,\n                SingleCharString: tags.special(tags.string),\n                TwoCharString: tags.special(tags.string),\n                \"Number!\": tags.number,\n                TwoCharNumber: tags.special(tags.number),\n                Branch: tags.punctuation,\n                ContextIndex: tags.controlKeyword,\n                Comment: tags.comment,\n                Element: tags.keyword,\n            }),\n        ],\n    }),\n});\n","// This file was generated by lezer-generator. You probably shouldn't edit it.\nimport {LRParser} from \"@lezer/lr\"\nconst spec_WeirdKW = {__proto__:null,for:10, if:12, \"do-to-each\":14, \"for<\":16, \"relation<\":18, \"yes?\":20, \"generate<\":22, while:24, \"?\":26, \"while<\":28, \"generate-from<\":30, \"each-as\":32, \"->\":36, \"else:\":38, else:40, elif:42, \"else-if\":44, body:46, do:48, branch:50, then:52, in:54, using:56, \"no?\":58, \"=>\":60, from:62, as:64, with:66, given:68, \":and:\":70, has:72, does:74, on:76, \"map-permutations<\":80, \"map-perms\":82, \"map-lam\":84, \"reduce-lam\":86, \"eager-map-lambda\":88, \"sort<\":90, \"map-permutations\":92, \"fold-lam\":94, \"fold-lambda\":96, \"eager-map-lam\":98, \"fold<\":100, \"sort-lambda\":102, \"filter-lambda\":104, \"map<\":106, lam:108, \"filter-lam\":110, \"permutations<\":112, \"sort-lam\":114, lambda:116, \"map-lambda\":118, \"eager-map<\":120, \"filter<\":122, \"reduce-lambda\":124, \"reduce<\":126}\nexport const __parser = LRParser.deserialize({\n  version: 14,\n  states: \")YOQOPOOOOOO'#C^'#C^OOOO'#Dv'#DvQQOPOOOuOPO'#C_OzOPO'#CmO!POPO'#DTOOOO-E7t-E7tO!UOPO,58yO!ZOPO,59XO!`OPO,59oO!eOPO1G.eO!jOPO1G.sO!oOPO1G/ZO!tOPO7+$PO!yOPO7+$_O#OOPO7+$uO#TOPO<<GkO#YOPO<<GyO#_OPO<<HaO#dOPOAN=VO#iOPOAN=eO#nOPOAN={O#sOPOG22qO#xOPOG23PO#}OPOG23gO$SOPOLD(]O$XOPOLD(kO$^OPOLD)RO$cOPO!$'KwO$hOPO!$'LVO$mOPO!$'LmO$rOPO!)9AcO$wOPO!)9AqO$|OPO!)9BXO%ROPO!.K6}O%WOPO!.K7]O%]OPO!.K7sOOOO!4/,i!4/,iO%bOPO!4/,wO%gOPO!4/-_O%lOPO!9A!cO%qOPO!9A!yO%vOPO!?$E}O%{OPO!?$FeO&QOPO!D6;iO&VOPO!D6<PO&[OPO!IH1TO&aOPO!IH1kO&fOPO# ,&oO&kOPO# ,'VO&pOPO#&=JZO&uOPO#&=JqO&zOPO#, ?uO'POPO#, @]O'UOPO#135aO'ZOPO#135wO'`OPO#6E*{O'eOPO#6E+cOOOO#<(Ng#<(NgO'jOPO#<(N}O'oOPO#A:DiOOOO#FL:T#FL:T\",\n  stateData: \"'{~OTSObTOxUO!bPO!cPO!dPO!ePO!fPO!gPO!hPO!iPO~OUWO~OcXO~OyYO~OVZO~Od[O~Oz]O~OW^O~Oe_O~O{`O~OXaO~OfbO~O|cO~OYdO~OgeO~O}fO~OZgO~OhhO~O!OiO~O[jO~OikO~O!PlO~O]mO~OjnO~O!QoO~O^pO~OkqO~O!RrO~O_sO~OltO~O!SuO~O`vO~OmwO~O!TxO~OnyO~O!UzO~Oo{O~O!V|O~Op}O~O!W!OO~Oq!PO~O!X!QO~Or!RO~O!Y!SO~Os!TO~O!Z!UO~Ot!VO~O![!WO~Ou!XO~O!]!YO~Ol!ZO~O!^![O~Ov!]O~O!_!^O~O!`!_O~O!a!`O~O!e!d!h!cS!h~\",\n  goto: \"!z!kPP!l!pPPPPPPPPPPPPP!pPPPPPPPPPPPPPPPPPPPPP!pPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP!tTQORTPORQRORVR\",\n  nodeNames: \"⚠ Program Word Structure WeirdKW for if do-to-each for< relation< yes? generate< while ? while< generate-from< each-as Branch -> else: else elif else-if body do branch then in using no? => from as with given :and: has does on Lambda map-permutations< map-perms map-lam reduce-lam eager-map-lambda sort< map-permutations fold-lam fold-lambda eager-map-lam fold< sort-lambda filter-lambda map< lam filter-lam permutations< sort-lam lambda map-lambda eager-map< filter< reduce-lambda reduce< String Number NormalKW ModifierKW VariableThing ListStuff GroupStuff Comment\",\n  maxTerm: 73,\n  skippedNodes: [0,4],\n  repeatNodeCount: 1,\n  tokenData: \"*}~R_rs!Qst$Wtu$uxy%ayz%l}!O%|!O!P'S!Q!R'S!R!['X![!]'a!a!b%|!c!}'v!}#O*x#P#Q*x#T#o'v~!TZOr!Qrs!vs#O!Q#O#P!{#P$Ip!Q$Ip$Iq!v$Iq$Ir!v$Ir$Is!v$Is;'S!Q;'S;=`$Q<%lO!Q~!{O!b~~#ORO;'S!Q;'S;=`#X;=`O!Q~#[[Or!Qrs!vs#O!Q#O#P!{#P$Ip!Q$Ip$Iq!v$Iq$Ir!v$Ir$Is!v$Is;'S!Q;'S;=`$Q;=`<%l!Q<%lO!Q~$TP;=`<%l!Q~$ZPst$^~$cS!i~OY$^Z;'S$^;'S;=`$o<%lO$^~$rP;=`<%l$^~$xQ!c!}%O#T#o%O~%TS!f~!Q![%O!c!}%O#R#S%O#T#o%O~%fQ!h~!O!P%l![!]%q~%qO!h~~%vQ!h~!O!P%l![!]%l~&R^S~qr%|uv%|vw%|z{%|{|%|}!O%|!Q![%|![!]&}!^!_%|!_!`%|!`!a%|!a!b%|!c!}%|#T#o%|~'SOS~~'XO!c~~'^P!c~!Q!['X~'dQ!_!`'j!`!a$u~'mR!c!}%O!}#O$u#T#o%O~'}`!d~S~qr'vuv'vvw'vz{'v{|'v}!O'v!Q!['v![!])P!^!_'v!_!`'v!`!a'v!a!b'v!c!}'v#T#b'v#b#c)W#c#o'v~)WO!e~S~~)_a!d~S~qr'vuv'vvw'vwx*dz{'v{|'v}!O'v!Q!['v![!])P!^!_'v!_!`'v!`!a'v!a!b'v!c!}'v#T#b'v#b#c)W#c#o'v~*gP#h#i*j~*oP!d~#b#c*r~*uPwx*d~*}O!g~\",\n  tokenizers: [0],\n  topRules: {\"Program\":[0,1]},\n  specialized: [{term: 4, get: (value) => spec_WeirdKW[value] || -1}],\n  tokenPrec: 312\n})\n\nexport default __parser\n// This file was generated by lezer-generator. You probably shouldn't edit it.\nexport const\n  Program = 1,\n  Word = 2,\n  Structure = 3,\n  WeirdKW = 4,\n  _for = 5,\n  _if = 6,\n  _while = 12,\n  Branch = 17,\n  _else = 20,\n  elif = 21,\n  body = 23,\n  _do = 24,\n  branch = 25,\n  then = 26,\n  _in = 27,\n  using = 28,\n  from = 31,\n  as = 32,\n  _with = 33,\n  given = 34,\n  has = 36,\n  does = 37,\n  on = 38,\n  Lambda = 39,\n  lam = 54,\n  lambda = 58,\n  String = 64,\n  Number = 65,\n  NormalKW = 66,\n  ModifierKW = 67,\n  VariableThing = 68,\n  ListStuff = 69,\n  GroupStuff = 70,\n  Comment = 71\n","import { LRLanguage } from \"@codemirror/language\";\nimport { styleTags, tags } from \"@lezer/highlight\";\nimport parser from \"./vyxal-lit.grammar\";\nexport const vyxalLitLanguage = LRLanguage.define({\n    parser: parser.configure({\n        props: [\n            styleTags({\n                Structure: tags.controlKeyword,\n                Branch: tags.controlKeyword,\n                Lambda: tags.controlKeyword,\n                String: tags.string,\n                Number: tags.number,\n                Element: tags.keyword,\n                Modifier: tags.moduleKeyword,\n                VariableThing: tags.variableName,\n                ListStuff: tags.literal,\n                GroupStuff: tags.keyword,\n                Comment: tags.comment,\n            }),\n        ],\n    }),\n});\n","import { LanguageSupport, syntaxTree } from \"@codemirror/language\";\nimport { hoverTooltip } from \"@codemirror/view\";\nimport { createRoot } from \"react-dom/client\";\nimport { ThingCard } from \"../ui/ThingCard\";\nimport { vyxalLanguage } from \"../../../common/scripts/language/vyxal\";\nimport { vyxalLitLanguage } from \"../../../common/scripts/language/vyxal-lit\";\nconst KEYWORD = /[a-zA-Z-?!*+=&%<>][a-zA-Z0-9-?!*+=&%<>:]*/;\nconst PREFIXED_KEYWORD = new RegExp(`( |^)${KEYWORD.source}`);\nfunction elementCompletion(thing, literate) {\n    return {\n        label: literate && thing.type != \"syntax\" ? thing.keywords[0] ?? \"<error>\" : thing.symbol,\n        detail: thing.name,\n        info() {\n            const container = document.createElement(\"div\");\n            const root = createRoot(container);\n            root.render(ThingCard({ thing }));\n            return {\n                dom: container,\n                destroy() {\n                    setTimeout(() => root.unmount());\n                },\n            };\n        },\n        type: thing.type == \"element\" ? \"method\" : \"keyword\",\n    };\n}\nfunction syncElementAutocomplete(fuse, context, literate) {\n    const word = context.matchBefore(literate ? KEYWORD : PREFIXED_KEYWORD);\n    if (word != null) {\n        const results = fuse.search(word.text.trimStart());\n        if (!results.length) {\n            return null;\n        }\n        return {\n            from: word.from,\n            filter: false,\n            options: results.map((result) => ({ ...elementCompletion(result.item, literate), boost: 10 * (1 - (result.score ?? 0)) })),\n            update: (current, from, to, context) => syncElementAutocomplete(fuse, context, literate),\n        };\n    }\n    return null;\n}\nexport async function elementAutocomplete(elementData, context, literate) {\n    const sync = syncElementAutocomplete(elementData.fuse, context, literate);\n    if (sync != null) {\n        return Promise.resolve(sync);\n    }\n    if (context.explicit) {\n        return {\n            from: context.pos,\n            to: context.pos,\n            filter: false,\n            options: [...elementData.elements.values()].map((e) => elementCompletion(e, literate)),\n            update: (current, from, to, context) => syncElementAutocomplete(elementData.fuse, context, literate),\n        };\n    }\n    return Promise.resolve(null);\n}\nexport function elementTooltip(elementData, literate) {\n    return hoverTooltip((view, pos) => {\n        const node = syntaxTree(view.state).resolve(pos, 1);\n        const hovered = view.state.doc.sliceString(node.from, node.to);\n        let thing;\n        if (node.name == \"Element\" || node.name == \"Digraph\" || node.name == \"Modifier\") {\n            thing = (node.name == \"Modifier\" ? (literate ? elementData.modifiersByKeyword : elementData.modifiers) : (literate ? elementData.elementsByKeyword : elementData.elements)).get(hovered);\n        }\n        else if (elementData.syntax.has(hovered)) {\n            thing = elementData.syntax.get(hovered);\n        }\n        else {\n            return null;\n        }\n        if (thing !== undefined) {\n            return {\n                pos: pos,\n                create() {\n                    const container = document.createElement(\"div\");\n                    const card = ThingCard({ thing, shadow: true });\n                    const root = createRoot(container);\n                    root.render(card);\n                    return {\n                        dom: container,\n                        destroy() {\n                            setTimeout(() => root.unmount());\n                        },\n                    };\n                },\n            };\n        }\n        return null;\n    });\n}\nexport const vyxal = new LanguageSupport(vyxalLanguage);\nexport const vyxalLiterate = new LanguageSupport(vyxalLitLanguage);\n","import { elementAutocomplete } from \"../common\";\nimport { vyxalLanguage } from \"../../../../common/scripts/language/vyxal\";\nexport function vyxalCompletion(elementData) {\n    return vyxalLanguage.data.of({\n        autocomplete(context) {\n            const sugar = context.matchBefore(/#[,.^](.)/);\n            if (sugar != null) {\n                const desugared = elementData.sugars.get(sugar.text);\n                if (typeof desugared == \"string\") {\n                    return Promise.resolve({\n                        from: sugar.from,\n                        filter: false,\n                        options: [\n                            { label: desugared, detail: \"sugar trigraph\", type: \"constant\" },\n                        ],\n                    });\n                }\n            }\n            return elementAutocomplete(elementData, context, false);\n        },\n    });\n}\n","import { syntaxTree } from \"@codemirror/language\";\nimport { combineConfig, Facet, StateField } from \"@codemirror/state\";\nimport { Decoration, WidgetType } from \"@codemirror/view\";\nimport { EditorView } from \"codemirror\";\nconst theme = EditorView.baseTheme({\n    \"&.cm-focused .cm-matchingBracket\": { backgroundColor: \"#328c8252\" },\n    \"&.cm-focused .cm-nonmatchingBracket\": { backgroundColor: \"#bb555544\" },\n    \"&:not(.cm-focused) .cm-eofMarker\": { display: \"none\" },\n    \".cm-eofMarker\": { display: \"inline\" },\n});\nconst matchingMark = Decoration.mark({ class: \"cm-matchingBracket\" });\nconst nonmatchingMark = Decoration.mark({ class: \"cm-nonmatchingBracket\" });\nclass EOFWidget extends WidgetType {\n    eq() {\n        return true;\n    }\n    toDOM() {\n        const element = document.createElement(\"span\");\n        element.classList.add(\"cm-eofMarker\");\n        element.classList.add(\"cm-placeholder\");\n        element.classList.add(\"cm-matchingBracket\");\n        element.textContent = \"␄\";\n        return element;\n    }\n}\nconst eofWidget = Decoration.widget({\n    widget: new EOFWidget(),\n    side: 1,\n});\nconst bracketMatchingConfig = Facet.define({\n    combine(configs) {\n        return combineConfig(configs, {\n            showEof: false,\n        });\n    },\n});\nfunction matchBrackets(state, position, side) {\n    const tree = syntaxTree(state);\n    const startNode = tree.resolveInner(position, side);\n    if (startNode.type.name == \"StructureOpen\") {\n        const iter = tree.cursorAt(position, side);\n        let depth = 0;\n        do {\n            if (iter.name == \"StructureClose\") {\n                const closer = state.doc.sliceString(iter.from, iter.to);\n                if (closer == \"}\") {\n                    depth--;\n                }\n                else if (closer == \")\") {\n                    depth -= 2;\n                }\n                else if (closer == \"]\") {\n                    depth = 0;\n                }\n                if (depth <= 0) {\n                    return { matched: true, start: [startNode], end: iter.node };\n                }\n            }\n            else if (iter.name == \"StructureOpen\") {\n                depth++;\n            }\n        } while (iter.next(true));\n        return { matched: true, start: [startNode], end: null };\n    }\n    else if (startNode.type.name == \"StructureClose\") {\n        let openers = [];\n        tree.iterate({\n            enter(node) {\n                if (node.name == \"StructureClose\") {\n                    const closer = state.doc.sliceString(node.from, node.to);\n                    if (closer == \"}\") {\n                        openers.pop();\n                    }\n                    else if (closer == \")\") {\n                        openers.splice(openers.length - 2);\n                    }\n                    else if (closer == \"]\") {\n                        openers = [];\n                    }\n                }\n                else if (node.name == \"StructureOpen\") {\n                    openers.push(node.node);\n                }\n            },\n            from: 0,\n            to: startNode.from - 1,\n        });\n        const closer = state.doc.sliceString(startNode.from, startNode.to);\n        if (closer == \"}\") {\n            if (openers.length >= 1) {\n                return { matched: true, start: [openers.pop()], end: startNode };\n            }\n        }\n        else if (closer == \")\") {\n            if (openers.length >= 2) {\n                return { matched: true, start: openers.splice(openers.length - 2), end: startNode };\n            }\n        }\n        else if (closer == \"]\") {\n            if (openers.length > 0) {\n                return { matched: true, start: openers, end: startNode };\n            }\n        }\n        else {\n            throw new Error(`Unexpected StructureClose ${closer}`);\n        }\n        return { matched: false, highlight: startNode };\n    }\n    return null;\n}\nconst bracketMatchingState = StateField.define({\n    create() {\n        return Decoration.none;\n    },\n    update(decorationSet, transaction) {\n        if (!transaction.docChanged && !transaction.selection) {\n            return decorationSet;\n        }\n        const decorations = [];\n        const config = transaction.state.facet(bracketMatchingConfig);\n        for (const range of transaction.state.selection.ranges) {\n            if (!range.empty) {\n                continue;\n            }\n            const match = matchBrackets(transaction.state, range.head, 1 /* Side.FORWARDS */) ?? matchBrackets(transaction.state, range.head, -1 /* Side.BACKWARDS */);\n            if (match) {\n                if (match.matched) {\n                    match.start.map((node) => decorations.push(matchingMark.range(node.from, node.to)));\n                    if (match.end) {\n                        decorations.push(matchingMark.range(match.end.from, match.end.to));\n                    }\n                    else if (config.showEof) {\n                        decorations.push(eofWidget.range(transaction.state.doc.length));\n                    }\n                }\n                else {\n                    decorations.push(nonmatchingMark.range(match.highlight.from, match.highlight.to));\n                }\n            }\n        }\n        return Decoration.set(decorations, true);\n    },\n    provide: (f) => EditorView.decorations.from(f),\n});\nexport function vyxalBracketMatching(config) {\n    return [bracketMatchingConfig.of(config), theme, bracketMatchingState];\n}\n","import { syntaxTree } from \"@codemirror/language\";\nimport { Compartment, Facet, Prec } from \"@codemirror/state\";\nimport { Decoration, EditorView, ViewPlugin, WidgetType } from \"@codemirror/view\";\nclass CompressButtonWidget extends WidgetType {\n    toDOM() {\n        const container = document.createElement(\"span\");\n        container.classList.add(\"cm-placeholder\");\n        const spinner = container.appendChild(document.createElement(\"div\"));\n        spinner.classList.add(\"spinner-border\", \"spinner-border-sm\");\n        spinner.hidden = true;\n        const icon = container.appendChild(document.createElement(\"i\"));\n        icon.ariaHidden = \"true\";\n        icon.classList.add(\"cm-compress-button\", \"bi\", \"bi-file-zip\");\n        icon.style.cursor = \"pointer\";\n        return container;\n    }\n    updateDOM(dom, view) {\n        const compressing = view.state.facet(CompressButtonPlugin.compressing);\n        dom.querySelector(\".spinner-border\").hidden = !compressing;\n        dom.querySelector(\".cm-compress-button\").hidden = compressing;\n        return true;\n    }\n    ignoreEvent() {\n        return false;\n    }\n}\nfunction insertButtons(view) {\n    const widgets = [];\n    for (const { from, to } of view.visibleRanges) {\n        syntaxTree(view.state).iterate({\n            from, to,\n            enter(node) {\n                const text = view.state.sliceDoc(node.from, node.to);\n                if (node.name == \"String\" && /[^“„]$/.test(text)) {\n                    widgets.push(Decoration.widget({\n                        widget: new CompressButtonWidget(),\n                        side: 1,\n                    }).range(/[\"”]$/.test(text) && text.length > 1 ? node.to - 1 : node.to));\n                }\n            },\n        });\n    }\n    return Decoration.set(widgets);\n}\nclass CompressButtonPlugin {\n    constructor(view, util) {\n        this.util = util;\n        this.decorations = insertButtons(view);\n    }\n    update(update) {\n        this.decorations = insertButtons(update.view);\n    }\n    toggleCompression(view, position) {\n        if (view.state.facet(CompressButtonPlugin.compressing)) {\n            return false;\n        }\n        const node = syntaxTree(view.state).resolveInner(position, -1);\n        if (node.name == \"String\") {\n            let text = view.state.sliceDoc(node.from, node.to);\n            const isCompressed = text.endsWith(\"”\");\n            if (!(isCompressed || text.endsWith(`\"`))) {\n                text += `\"`;\n            }\n            const trimmed = text.slice(1, -1);\n            view.dispatch({\n                effects: CompressButtonPlugin.lock.reconfigure(Prec.highest([\n                    EditorView.editable.of(false), CompressButtonPlugin.compressing.of(true),\n                ])),\n            });\n            (isCompressed ? this.util.decompress(trimmed) : this.util.compress(trimmed)).then((result) => {\n                view.dispatch({\n                    changes: {\n                        from: node.from,\n                        to: node.to,\n                        insert: isCompressed ? `\"${result}\"` : `\"${result}”`,\n                    },\n                    effects: CompressButtonPlugin.lock.reconfigure([]),\n                });\n            });\n            return true;\n        }\n        return false;\n    }\n}\nCompressButtonPlugin.lock = new Compartment;\nCompressButtonPlugin.compressing = Facet.define({ combine: values => values.length ? values[0] : false });\nCompressButtonPlugin.spec = {\n    decorations: (v) => v.decorations,\n    eventHandlers: {\n        click: function (event, view) {\n            const target = event.target;\n            if (target.classList.contains(\"cm-compress-button\")) {\n                return this.toggleCompression(view, view.posAtDOM(target));\n            }\n            return false;\n        },\n    },\n    provide: () => CompressButtonPlugin.lock.of([]),\n};\nexport function compressButtonPlugin(util) {\n    return ViewPlugin.define((view) => new CompressButtonPlugin(view, util), CompressButtonPlugin.spec);\n}\n","import { syntaxTree } from \"@codemirror/language\";\nimport { MapMode } from \"@codemirror/state\";\nimport { hoverTooltip } from \"@codemirror/view\";\nexport function vyxalHover(util) {\n    async function makeStringTooltip(view, node) {\n        if (node.name != \"String\") {\n            return null;\n        }\n        const content = view.state.sliceDoc(node.from, node.to);\n        if (content.at(-1) == \"”\") {\n            const decompressed = await util.decompress(content.slice(1, -1));\n            const container = document.createElement(\"div\");\n            container.innerHTML = `<div class=\"card shadow\"><div class=\"card-body\">Compressed string: <code>${decompressed}</code></div></div>`;\n            return container;\n        }\n        return null;\n    }\n    const stringTooltip = hoverTooltip(async (view, pos) => {\n        const node = syntaxTree(view.state).resolve(pos);\n        const element = await makeStringTooltip(view, node);\n        if (element != null) {\n            const container = document.createElement(\"div\");\n            container.appendChild(element);\n            return {\n                pos: pos,\n                create: () => {\n                    return {\n                        dom: container,\n                        update: async (update) => {\n                            if (update.changes.touchesRange(node.from, node.to)) {\n                                const newPos = update.changes.mapPos(pos, -1, MapMode.TrackDel);\n                                if (newPos != null) {\n                                    const element = await makeStringTooltip(view, syntaxTree(view.state).resolve(newPos));\n                                    if (element != null) {\n                                        container.replaceChildren(element);\n                                    }\n                                }\n                            }\n                        },\n                    };\n                },\n            };\n        }\n        return null;\n    });\n    return [stringTooltip];\n}\n","import { vyxalLitLanguage } from \"../../../../common/scripts/language/vyxal-lit\";\nimport { elementAutocomplete } from \"../common\";\nexport function vyxalLitCompletion(elementData) {\n    return vyxalLitLanguage.data.of({\n        autocomplete(context) {\n            return elementAutocomplete(elementData, context, true);\n        },\n    });\n}\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { useCallback, useContext, useMemo, useRef, useState } from \"react\";\nimport ReactCodeMirror, { keymap, Prec } from \"@uiw/react-codemirror\";\nimport { minimalSetup } from \"codemirror\";\nimport { vscodeDark } from \"@uiw/codemirror-theme-vscode\";\nimport { vyxalCompletion } from \"../language/sbcs/autocomplete\";\nimport { autocompletion } from \"@codemirror/autocomplete\";\nimport { EditorView, highlightActiveLine, highlightActiveLineGutter, lineNumbers, showPanel } from \"@codemirror/view\";\nimport { Theme } from \"./settings\";\nimport { githubLight } from \"@uiw/codemirror-theme-github\";\nimport { ElementDataContext } from \"../interpreter/element-data\";\nimport { createPortal } from \"react-dom\";\nimport { ErrorBoundary } from \"react-error-boundary\";\nimport { Button, Stack } from \"react-bootstrap\";\nimport { vyxalBracketMatching } from \"../language/sbcs/bracket-matching\";\nimport { elementTooltip, vyxal, vyxalLiterate } from \"../language/common\";\nimport { compressButtonPlugin } from \"../language/sbcs/compression\";\nimport { vyxalHover } from \"../language/sbcs/tooltips\";\nimport { vyxalLitCompletion } from \"../language/literate/autocomplete\";\nconst commonExtensions = [\n    Prec.high(keymap.of([\n        {\n            key: \"Ctrl-Enter\",\n            run(view) {\n                if (view.state.doc.length <= 0) {\n                    return false;\n                }\n                window.dispatchEvent(new Event(\"run-vyxal\")); // dubious\n                return true;\n            },\n            preventDefault: true,\n        },\n    ])),\n    minimalSetup,\n    autocompletion(),\n    lineNumbers(),\n    highlightActiveLine(),\n    highlightActiveLineGutter(),\n    EditorView.theme({\n        \"&\": { height: \"100%\" },\n        \"&.cm-focused\": { outline: \"none\" },\n        \".cm-scroller\": { overflow: \"auto\" },\n        \".cm-tooltip\": { \"z-index\": \"400 !important\" },\n    }),\n];\nconst THEMES = {\n    [Theme.Dark]: vscodeDark,\n    [Theme.Light]: githubLight,\n};\nfunction EditorError({ error, resetErrorBoundary }) {\n    return _jsxs(Stack, { direction: \"vertical\", className: \"bg-danger-subtle p-2 position-absolute\", children: [_jsxs(\"h3\", { className: \"text-danger\", children: [_jsx(\"i\", { className: \"bi bi-x-circle\" }), \" An error occured\"] }), _jsx(Button, { variant: \"danger\", onClick: resetErrorBoundary, children: \"Reset editor\" }), error.toString(), _jsx(\"div\", { children: error.stack })] });\n}\nexport default function Editor({ utilWorker, initialValue, children, setCode, settings, literate, claimFocus, autoFocus, height }) {\n    const elementData = useContext(ElementDataContext);\n    const editorRef = useRef(null);\n    const onChange = useCallback((code) => {\n        setCode(code);\n    }, [setCode]);\n    const [headerDom, setHeaderDom] = useState(null);\n    const header = useMemo(() => showPanel.of(() => {\n        const dom = document.createElement(\"div\");\n        dom.classList.add(\"p-1\");\n        setHeaderDom(dom);\n        return { dom, top: true };\n    }), []);\n    const focusChangeHandler = useMemo(() => EditorView.focusChangeEffect.of((state, focusing) => {\n        if (focusing && editorRef.current) {\n            claimFocus(editorRef.current);\n        }\n        return null;\n    }), [claimFocus]);\n    const languageExtensions = useMemo(() => literate ? [\n        vyxalLiterate, vyxalLitCompletion(elementData), elementTooltip(elementData, true),\n    ] : [\n        vyxal, vyxalCompletion(elementData), vyxalHover(utilWorker), elementTooltip(elementData, false), compressButtonPlugin(utilWorker),\n    ], [elementData, literate, utilWorker]);\n    const extensions = [\n        commonExtensions, header, focusChangeHandler,\n        languageExtensions,\n        useMemo(() => settings.highlightBrackets != \"no\" ? vyxalBracketMatching({ showEof: settings.highlightBrackets == \"yes-eof\" }) : [], [settings]),\n    ];\n    return _jsx(_Fragment, { children: _jsxs(ErrorBoundary, { FallbackComponent: EditorError, children: [_jsx(ReactCodeMirror, { basicSetup: false, theme: THEMES[settings.theme], value: initialValue, onChange: onChange, extensions: extensions, ref: editorRef, autoFocus: autoFocus, style: { height } }), headerDom !== null && createPortal(children, headerDom)] }) });\n}\n;\n"],"names":["deserialize","version","states","stateData","goto","nodeNames","maxTerm","skippedNodes","repeatNodeCount","tokenData","tokenizers","topRules","tokenPrec","vyxalLanguage","define","parser","configure","props","Digraph","function","propertyName","SyntaxTrigraph","operator","StructureOpen","bracket","StructureClose","ListStuff","Modifier","moduleKeyword","VariableThing","variableName","String","string","SingleCharString","special","TwoCharString","number","TwoCharNumber","Branch","punctuation","ContextIndex","controlKeyword","Comment","comment","Element","keyword","spec_WeirdKW","__proto__","for","if","while","else","elif","body","do","branch","then","in","using","from","as","with","given","has","does","on","lam","lambda","specialized","term","get","value","vyxalLitLanguage","Structure","Lambda","Number","literal","GroupStuff","KEYWORD","PREFIXED_KEYWORD","RegExp","source","elementCompletion","thing","literate","label","type","keywords","symbol","detail","name","info","container","document","createElement","root","render","ThingCard","dom","destroy","setTimeout","unmount","syncElementAutocomplete","fuse","context","word","matchBefore","results","search","text","trimStart","length","filter","options","map","result","item","boost","score","update","current","to","async","elementAutocomplete","elementData","sync","Promise","resolve","explicit","pos","elements","values","e","elementTooltip","view","node","state","hovered","doc","sliceString","modifiersByKeyword","modifiers","elementsByKeyword","syntax","undefined","create","card","shadow","vyxal","vyxalLiterate","vyxalCompletion","data","of","autocomplete","sugar","desugared","sugars","theme","baseTheme","backgroundColor","display","matchingMark","mark","class","nonmatchingMark","EOFWidget","eq","toDOM","element","classList","add","textContent","eofWidget","widget","side","bracketMatchingConfig","combine","configs","showEof","matchBrackets","position","tree","startNode","resolveInner","iter","cursorAt","depth","closer","matched","start","end","next","openers","iterate","enter","pop","splice","push","Error","highlight","bracketMatchingState","none","decorationSet","transaction","docChanged","selection","decorations","config","facet","range","ranges","empty","match","head","set","provide","f","CompressButtonWidget","spinner","appendChild","hidden","icon","ariaHidden","style","cursor","updateDOM","compressing","CompressButtonPlugin","querySelector","ignoreEvent","insertButtons","widgets","visibleRanges","sliceDoc","test","constructor","util","this","toggleCompression","isCompressed","endsWith","trimmed","slice","dispatch","effects","lock","reconfigure","highest","editable","decompress","compress","changes","insert","vyxalHover","makeStringTooltip","content","at","decompressed","innerHTML","touchesRange","newPos","mapPos","TrackDel","replaceChildren","vyxalLitCompletion","spec","v","eventHandlers","click","event","target","contains","posAtDOM","commonExtensions","high","key","run","window","dispatchEvent","Event","preventDefault","height","outline","overflow","THEMES","Dark","Light","EditorError","error","resetErrorBoundary","Stack","direction","className","children","Button","variant","onClick","toString","stack","Editor","utilWorker","initialValue","setCode","settings","claimFocus","autoFocus","useContext","editorRef","useRef","onChange","useCallback","code","headerDom","setHeaderDom","useState","header","useMemo","top","focusChangeHandler","focusChangeEffect","focusing","languageExtensions","extensions","highlightBrackets","FallbackComponent","basicSetup","ref","createPortal"],"sourceRoot":""}