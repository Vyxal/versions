{"version":3,"file":"scripts/editor.bc2626a6.js","mappings":"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","sources":["webpack:///./src/latest/scripts/extensions/common.ts","webpack:///./src/common/scripts/languages/vyxal.grammar","webpack:///./src/common/scripts/languages/vyxal.ts","webpack:///./src/latest/scripts/extensions/vyxal/bracket-matching.ts","webpack:///./src/latest/scripts/extensions/vyxal/vyxal-extensions.ts","webpack:///./src/common/scripts/languages/vyxal-lit.grammar","webpack:///./src/common/scripts/languages/vyxal-lit.ts","webpack:///./src/latest/scripts/extensions/vyxal-lit-extensions.ts","webpack:///./src/latest/scripts/Editor.tsx"],"sourcesContent":["import { elementFuse, modifierFuse, syntaxFuse } from \"../util/element-data\";\nimport { syntaxTree } from \"@codemirror/language\";\nimport { hoverTooltip } from \"@codemirror/view\";\nimport { createRoot } from \"react-dom/client\";\nimport { ThingCard } from \"../ThingCard\";\nconst KEYWORD = /[a-zA-Z-?!*+=&%<>][a-zA-Z0-9-?!*+=&%<>:]*/;\nconst PREFIXED_KEYWORD = new RegExp(`( |^)${KEYWORD.source}`);\nfunction elementCompletion(thing, literate) {\n    return {\n        label: literate && thing.type != \"syntax\" ? thing.keywords[0] ?? \"<error>\" : thing.symbol,\n        detail: thing.name,\n        info() {\n            const container = document.createElement(\"div\");\n            const root = createRoot(container);\n            root.render(ThingCard({ thing }));\n            return {\n                dom: container,\n                destroy() {\n                    setTimeout(() => root.unmount());\n                },\n            };\n        },\n        type: thing.type == \"element\" ? \"method\" : \"keyword\",\n    };\n}\nfunction syncElementAutocomplete(context, literate) {\n    const word = context.matchBefore(literate ? KEYWORD : PREFIXED_KEYWORD);\n    if (word != null) {\n        word.text = word.text.trimStart();\n        const results = [...elementFuse.search(word.text), ...modifierFuse.search(word.text), ...syntaxFuse.search(word.text)];\n        if (!results.length) {\n            return null;\n        }\n        return {\n            from: word.from,\n            filter: false,\n            options: results.map((result) => ({ ...elementCompletion(result.item, literate), boost: 10 * (1 - (result.score ?? 0)) })),\n            update: (current, from, to, context) => syncElementAutocomplete(context, literate),\n        };\n    }\n    return null;\n}\nexport async function elementAutocomplete(elementData, context, literate) {\n    const sync = syncElementAutocomplete(context, literate);\n    if (sync != null) {\n        return Promise.resolve(sync);\n    }\n    if (context.explicit) {\n        return {\n            from: context.pos,\n            to: context.pos,\n            filter: false,\n            options: [...elementData.elements.values()].map((e) => elementCompletion(e, literate)),\n            update: (current, from, to, context) => syncElementAutocomplete(context, literate),\n        };\n    }\n    return Promise.resolve(null);\n}\nexport function elementTooltip(elementData, literate) {\n    return hoverTooltip((view, pos) => {\n        const node = syntaxTree(view.state).resolve(pos, 1);\n        const hovered = view.state.doc.sliceString(node.from, node.to);\n        let thing;\n        if (node.name == \"Element\" || node.name == \"Modifier\") {\n            thing = (node.name == \"Modifier\" ? (literate ? elementData.modifiersByKeyword : elementData.modifiers) : (literate ? elementData.elementsByKeyword : elementData.elements)).get(hovered);\n        }\n        else if (elementData.syntax.has(hovered)) {\n            thing = elementData.syntax.get(hovered);\n        }\n        else {\n            return null;\n        }\n        if (thing !== undefined) {\n            return {\n                pos: pos,\n                create() {\n                    const container = document.createElement(\"div\");\n                    const card = ThingCard({ thing, shadow: true });\n                    const root = createRoot(container);\n                    root.render(card);\n                    return {\n                        dom: container,\n                        destroy() {\n                            setTimeout(() => root.unmount());\n                        },\n                    };\n                },\n            };\n        }\n        return null;\n    });\n}\n","// This file was generated by lezer-generator. You probably shouldn't edit it.\nimport {LRParser} from \"@lezer/lr\"\nexport const __parser = LRParser.deserialize({\n  version: 14,\n  states: \"!QOVQPOOOOQO'#Ci'#CiOOQO'#Ch'#ChOOQO'#Cl'#ClOOQO'#C_'#C_OOQO'#Ct'#CtQVQPOOOOQO-E6r-E6r\",\n  stateData: \"!g~OPOS~OSSOTSOUSOVSOWSOXSOYSOZSO^PO_QOaRObROcROdSOeSOfSOgSOkPOlQO~OPg~\",\n  goto: \"|iPPPjPPPPPPPPnrPPnPPPPPPPvTTOUTSOUTQOUQUORVU\",\n  nodeNames: \"⚠ Space Program Statement Digraph SugarTrigraph SyntaxTrigraph StructureOpen StructureClose ListStuff Modifier VariableThing Number NumberDecimal NumberPart TwoCharNumber AnyString String SingleCharString TwoCharString Branch ContextIndex Comment Element\",\n  maxTerm: 28,\n  skippedNodes: [0,1],\n  repeatNodeCount: 1,\n  tokenData: \"7g~R#uOX)fX^)k^p)fpq)kqr)frs+Vst-itw)fwx2cxy1{yz2|z!O)f!O!P3R!P!Q3W!Q!R3]!R![3b![!})f!}#O1{#O#P)f#P#Q2|#Q#_)f#_#`3j#`#o)f#o#p1{#p#q4O#q#r2|#r#s4T#s#y)f#y#z)k#z$f)f$f$g)k$g$j)f$j$k5i$k${)f${$|1{$|%V)f%V%W3W%W%v)f%v%w3j%w&b)f&b&c3j&c'm)f'm'n5v'n){)f){)|1{)|5a)f5a5b1{5b6s)f6s6t3W6t8T)f8T8U3W8U8{)f8{8|3W8|#BY)f#BY#BZ)k#BZ$9g)f$9g$9h3W$9h$9i3W$9i$9s)f$9s$9t3W$9t$9v)f$9v$9w3W$9w$9x3W$9x$9{)f$9{$9|3W$9|$9}3W$9}$:O3W$:O$:T)f$:T$:U3W$:U$:V3W$:V$:W)f$:W$:X3W$:X$:[)f$:[$:]3W$:]$:^3W$:^$:_3W$:_$:a)f$:a$:b3W$:b$:c3W$:c$:d)f$:d$:e3W$:e$:g)f$:g$:h3W$:h$;t)f$;t$;u3W$;u$;x)f$;x$;y3W$;y$;|)f$;|$;}3W$;}$<Q)f$<Q$<R3W$<R$<S)f$<S$<T3W$<T$<])f$<]$<^3W$<^$<_5{$<_$<e)f$<e$<f3W$<f$>Y)f$>Y$>Z1{$>Z$?f)f$?f$?g1{$?g$IS)f$IS$I_)k$I_$Ip)f$Is$I|)f$I|$JO)k$JO$JT)f$JT$JU)k$JU$KV)f$KV$KW)k$KW$Kw)f$Kw$Kx3W$Kx$L})f$L}$MO1{$MO%&`)f%&`%&a3j%&a%'P)f%'P%'Q3W%'Q%'R3W%'R%GS)f%GS%GT1{%GT&;p)f&;p&;q3W&;q&FU)f&FU&FV)k&FV;'S)f;'S;=`7a<%lO)f~)kOg~~)rYP~g~X^*bpq*b#y#z*b$f$g*b#BY#BZ*b$IS$I_*b$I|$JO*b$JT$JU*b$KV$KW*b&FU&FV*b~*gYP~X^*bpq*b#y#z*b$f$g*b#BY#BZ*b$IS$I_*b$I|$JO*b$JT$JU*b$KV$KW*b&FU&FV*b~+Y]Or+Vrs,Rs#O+V#O#P,W#P$Ip+V$Ip$Iq,R$Iq$Ir,R$Ir$Is,R$Is;'S+V;'S;=`-c<%l~+V~O+V~~,R~,WOa~~,ZRO;'S+V;'S;=`,d;=`O+V~,g^Or+Vrs,Rs#O+V#O#P,W#P$Ip+V$Ip$Iq,R$Iq$Ir,R$Ir$Is,R$Is;'S+V;'S;=`-c;=`<%l+V<%l~+V~O+V~~,R~-fP;=`<%l+V~-lhOq/Wrs/Wst/]tu/tu|/W|}0`}!O/W!O!P0`!P![/W![!]0{!]!_/W!_!`/t!`!a/t!a!b/W!c!}/W!}#O2W#O#P/W#P#Q2W#Q#R0`#R#o/W#o#p1{#p;'S/W;'S;=`2]<%lO/W~/]OS~~/bSf~OY/]Z;'S/];'S;=`/n<%lO/]~/qP;=`<%l/]~/wQ!c!}/}#T#o/}~0SSZ~!Q![/}!c!}/}#R#S/}#T#o/}~0eRS~O;'S0n;'S;=`0s;=`O0n~0sOT~~0xPT~;=`<%l0n~1OVO![1e![!]1j!]!}1e!}#O/t#O;'S1e;'S;=`2Q<%lO1e~1jOU~~1oSU~{|1{!g!h1{!o!p1{!t!u1{~2QOV~~2TP;=`<%l1e~2]OX~~2`P;=`<%l/W~2fRO;'S2o;'S;=`2t;=`O2o~2tOb~~2yPb~;=`<%l2o~3ROW~~3WOk~~3]OY~~3bO^~~3gP^~!Q![3b~3mRO;'S/W;'S;=`3v;=`O/W~3{PS~;=`<%l/W~4TOd~~4WRO;'S4a;'S;=`4z;=`O4a~4dRO;'S4m;'S;=`4r;=`O4m~4rO_~~4wP_~;=`<%l4m~4}SO;'S4m;'S;=`4r;=`<%l5Z<%lO4m~5`R_~O;'S4m;'S;=`4r;=`O4m~5nPg~!Q![5q~5vOe~~5{Ol~~6ORO;'S6X;'S;=`6r;=`O6X~6[RO;'S6e;'S;=`6j;=`O6e~6jOc~~6oPc~;=`<%l6e~6uSO;'S6e;'S;=`6j;=`<%l7R<%lO6e~7WRc~O;'S6e;'S;=`6j;=`O6e~7dP;=`<%l)f\",\n  tokenizers: [0],\n  topRules: {\"Program\":[0,2]},\n  tokenPrec: 66\n})\n\nexport default __parser\n// This file was generated by lezer-generator. You probably shouldn't edit it.\nexport const\n  Space = 1,\n  Program = 2,\n  Statement = 3,\n  Digraph = 4,\n  SugarTrigraph = 5,\n  SyntaxTrigraph = 6,\n  StructureOpen = 7,\n  StructureClose = 8,\n  ListStuff = 9,\n  Modifier = 10,\n  VariableThing = 11,\n  Number = 12,\n  NumberDecimal = 13,\n  NumberPart = 14,\n  TwoCharNumber = 15,\n  AnyString = 16,\n  String = 17,\n  SingleCharString = 18,\n  TwoCharString = 19,\n  Branch = 20,\n  ContextIndex = 21,\n  Comment = 22,\n  Element = 23\n","import { LRLanguage } from \"@codemirror/language\";\nimport { styleTags, tags } from \"@lezer/highlight\";\nimport parser from \"./vyxal.grammar\";\nexport const vyxalLanguage = LRLanguage.define({\n    parser: parser.configure({\n        props: [\n            styleTags({\n                Digraph: tags.function(tags.propertyName),\n                SugarTrigraph: tags.macroName,\n                SyntaxTrigraph: tags.operator,\n                StructureOpen: tags.bracket,\n                StructureClose: tags.bracket,\n                Modifier: tags.modifier,\n                VariableThing: tags.variableName,\n                String: tags.string,\n                SingleCharString: tags.special(tags.string),\n                TwoCharString: tags.special(tags.string),\n                \"Number!\": tags.number,\n                TwoCharNumber: tags.special(tags.number),\n                Branch: tags.punctuation,\n                ContextIndex: tags.controlKeyword,\n                Comment: tags.comment,\n                Element: tags.keyword,\n            }),\n        ],\n    }),\n});\n","import { syntaxTree } from \"@codemirror/language\";\nimport { StateField } from \"@codemirror/state\";\nimport { Decoration, WidgetType } from \"@codemirror/view\";\nimport { EditorView } from \"codemirror\";\nconst theme = EditorView.baseTheme({\n    \"&.cm-focused .cm-matchingBracket\": { backgroundColor: \"#328c8252\" },\n    \"&.cm-focused .cm-nonmatchingBracket\": { backgroundColor: \"#bb555544\" },\n    \"&:not(.cm-focused) .cm-eofMarker\": { display: \"none\" },\n    \".cm-eofMarker\": { display: \"inline\" },\n});\nconst matchingMark = Decoration.mark({ class: \"cm-matchingBracket\" });\nconst nonmatchingMark = Decoration.mark({ class: \"cm-nonmatchingBracket\" });\nclass EOFWidget extends WidgetType {\n    eq() {\n        return true;\n    }\n    toDOM() {\n        const element = document.createElement(\"span\");\n        element.classList.add(\"cm-eofMarker\");\n        element.classList.add(\"cm-placeholder\");\n        element.classList.add(\"cm-matchingBracket\");\n        element.textContent = \"␄\";\n        return element;\n    }\n}\nconst eofWidget = Decoration.widget({\n    widget: new EOFWidget(),\n    side: 1,\n});\nfunction matchBrackets(state, position, side) {\n    const tree = syntaxTree(state);\n    const startNode = tree.resolveInner(position, side);\n    if (startNode.type.name == \"StructureOpen\") {\n        const iter = tree.cursorAt(position, side);\n        let depth = 0;\n        do {\n            if (iter.name == \"StructureClose\") {\n                const closer = state.doc.sliceString(iter.from, iter.to);\n                if (closer == \"}\") {\n                    depth--;\n                }\n                else if (closer == \")\") {\n                    depth -= 2;\n                }\n                else if (closer == \"]\") {\n                    depth = 0;\n                }\n                if (depth <= 0) {\n                    return { matched: true, start: [startNode], end: iter.node };\n                }\n            }\n            else if (iter.name == \"StructureOpen\") {\n                depth++;\n            }\n        } while (iter.next(true));\n        return { matched: true, start: [startNode], end: null };\n    }\n    else if (startNode.type.name == \"StructureClose\") {\n        let openers = [];\n        tree.iterate({\n            enter(node) {\n                if (node.name == \"StructureClose\") {\n                    const closer = state.doc.sliceString(node.from, node.to);\n                    if (closer == \"}\") {\n                        openers.splice(openers.length - 2);\n                    }\n                    else if (closer == \")\") {\n                        openers.pop();\n                    }\n                    else if (closer == \"]\") {\n                        openers = [];\n                    }\n                }\n                else if (node.name == \"StructureOpen\") {\n                    openers.push(node.node);\n                }\n            },\n            from: 0,\n            to: startNode.from - 1,\n        });\n        const closer = state.doc.sliceString(startNode.from, startNode.to);\n        if (closer == \"}\") {\n            if (openers.length >= 1) {\n                return { matched: true, start: [openers.pop()], end: startNode };\n            }\n        }\n        else if (closer == \")\") {\n            if (openers.length >= 2) {\n                return { matched: true, start: openers.splice(openers.length - 2), end: startNode };\n            }\n        }\n        else if (closer == \"]\") {\n            if (openers.length > 0) {\n                return { matched: true, start: openers, end: startNode };\n            }\n        }\n        else {\n            throw new Error(`Unexpected StructureClose ${closer}`);\n        }\n        return { matched: false, highlight: startNode };\n    }\n    return null;\n}\nconst bracketMatchingState = StateField.define({\n    create() {\n        return Decoration.none;\n    },\n    update(decorationSet, transaction) {\n        if (!transaction.docChanged && !transaction.selection) {\n            return decorationSet;\n        }\n        const decorations = [];\n        for (const range of transaction.state.selection.ranges) {\n            if (!range.empty) {\n                continue;\n            }\n            const match = matchBrackets(transaction.state, range.head, 1 /* Side.FORWARDS */) ?? matchBrackets(transaction.state, range.head, -1 /* Side.BACKWARDS */);\n            if (match) {\n                if (match.matched) {\n                    match.start.map((node) => decorations.push(matchingMark.range(node.from, node.to)));\n                    if (match.end) {\n                        decorations.push(matchingMark.range(match.end.from, match.end.to));\n                    }\n                    else {\n                        decorations.push(eofWidget.range(transaction.state.doc.length));\n                    }\n                }\n                else {\n                    decorations.push(nonmatchingMark.range(match.highlight.from, match.highlight.to));\n                }\n            }\n        }\n        return Decoration.set(decorations, true);\n    },\n    provide: (f) => EditorView.decorations.from(f),\n});\nexport function vyxalBracketMatching() {\n    return [theme, bracketMatchingState];\n}\n","import { LanguageSupport, syntaxTree } from \"@codemirror/language\";\nimport { elementAutocomplete, elementTooltip } from '../common';\nimport { hoverTooltip } from \"@codemirror/view\";\nimport { MapMode } from \"@codemirror/state\";\nimport { vyxalLanguage } from \"../../../../common/scripts/languages/vyxal\";\nimport { vyxalBracketMatching } from \"./bracket-matching\";\nexport function vyxalCompletion(elementData) {\n    return vyxalLanguage.data.of({\n        autocomplete(context) {\n            const sugar = context.matchBefore(/#[,.^](.)/);\n            if (sugar != null) {\n                const desugared = elementData.sugars.get(sugar.text);\n                if (typeof desugared == \"string\") {\n                    return Promise.resolve({\n                        from: sugar.from,\n                        filter: false,\n                        options: [\n                            { label: desugared, detail: \"sugar trigraph\", type: \"constant\" },\n                        ],\n                    });\n                }\n            }\n            return elementAutocomplete(elementData, context, false);\n        },\n    });\n}\nexport function vyxalHover(util) {\n    async function makeStringTooltip(view, node) {\n        if (node.name != \"String\") {\n            return Promise.resolve(null);\n        }\n        const content = view.state.doc.slice(node.from, node.to).toString();\n        switch (content.at(-1)) {\n            case \"\\\"\": {\n                return Promise.resolve(null);\n            }\n            case \"„\": {\n                const decompressed = await util.decompress(content);\n                const container = document.createElement(\"div\");\n                container.innerHTML = `<b>Compressed string: </b> ${decompressed}`;\n                return container;\n            }\n            default:\n                return Promise.resolve(null);\n        }\n    }\n    const stringTooltip = hoverTooltip(async (view, pos) => {\n        const node = syntaxTree(view.state).resolve(pos);\n        const element = await makeStringTooltip(view, node);\n        if (element != null) {\n            const container = document.createElement(\"div\");\n            container.appendChild(element);\n            return {\n                pos: pos,\n                create: () => {\n                    return {\n                        dom: container,\n                        update: async (update) => {\n                            if (update.changes.touchesRange(node.from, node.to)) {\n                                const newPos = update.changes.mapPos(pos, -1, MapMode.TrackDel);\n                                if (newPos != null) {\n                                    const element = await makeStringTooltip(view, syntaxTree(view.state).resolve(newPos));\n                                    if (element != null) {\n                                        container.replaceChildren(element);\n                                    }\n                                }\n                            }\n                        },\n                    };\n                },\n            };\n        }\n        return null;\n    });\n    return [stringTooltip];\n}\nexport function vyxal(util, data) {\n    return new LanguageSupport(vyxalLanguage, [vyxalCompletion(data), vyxalHover(util), elementTooltip(data, false), vyxalBracketMatching()]);\n}\n","// This file was generated by lezer-generator. You probably shouldn't edit it.\nimport {LRParser} from \"@lezer/lr\"\nconst spec_WeirdKW = {__proto__:null,\"yes?\":10, \"?\":12, if:14, for:16, \"for<\":18, \"do-to-each\":20, \"each-as\":22, while:24, \"while<\":26, \"exists<\":28, \"relation<\":30, \"generate-from<\":32, \"generate<\":34, endfor:36, \"end-for\":38, endwhile:40, \"end-while\":42, endlambda:44, \"end-lambda\":46, end:48, \"end-end\":50, \"end-all\":52, \"close-all\":54, \"}\":56, \"->\":60, \"else:\":62, else:64, elif:66, \"else-if\":68, body:70, do:72, branch:74, then:76, in:78, using:80, \"no?\":82, \"=>\":84, from:86, as:88, with:90, given:92, \":and:\":94, has:96, does:98, on:100, \",\":102, lambda:106, lam:108, \"map-lambda\":110, \"map-lam\":112, \"map<\":114, \"filter-lambda\":116, \"filter-lam\":118, \"filter<\":120, \"reduce-lambda\":122, \"reduce-lam\":124, \"reduce<\":126, \"fold-lambda\":128, \"fold-lam\":130, \"fold<\":132, \"sort-lambda\":134, \"sort-lam\":136, \"sort<\":138, \"{\":140}\nexport const __parser = LRParser.deserialize({\n  version: 14,\n  states: \"!^OQOPOOOOOO'#C^'#C^OOOO'#D}'#D}QQOPOOOOOO'#C_'#C_O%qOPO'#C_OOOO'#Cy'#CyOOOO'#Db'#DbOOOO-E7{-E7{OOOO,58y,58y\",\n  stateData: \"%}~OTSOUSOVSOWSOXSOYSOZSO[SO]SO^SO_SO`TObSOcSOdSOeSOfSOgSOhSOiSOjSOkSOlSOnUOoUOpUOqUOrUOsUOtUOuUOvUOwUOxUOyUOzUO{UO|UO}UO!OUO!PUO!QUO!RUO!SUO!TUO!VVO!WVO!XVO!YVO!ZVO![VO!]VO!^VO!_VO!`VO!aVO!bVO!cVO!dVO!eVO!fVO!gVO!hVO!iPO!jPO!kPO!lPO!mPO!nPO!oPO!pPO~OaXO~O!l!k!o!jS!o~\",\n  goto: \"#R!rPP!s!wPPPPPPPPPPPPPPPPPPPPPPPPP!wPPPPPPPPPPPPPPPPPPPPPP!wPPPPPPPPPPPPPPPPPPPPPPPPPP!{TQORTPORQRORWR\",\n  nodeNames: \"⚠ Program Word Structure WeirdKW yes? ? if for for< do-to-each each-as while while< exists< relation< generate-from< generate< endfor end-for endwhile end-while endlambda end-lambda end end-end end-all close-all } Branch -> else: else elif else-if body do branch then in using no? => from as with given :and: has does on , Lambda lambda lam map-lambda map-lam map< filter-lambda filter-lam filter< reduce-lambda reduce-lam reduce< fold-lambda fold-lam fold< sort-lambda sort-lam sort< { String Number Element Modifier VariableThing ListStuff GroupStuff Comment\",\n  maxTerm: 80,\n  skippedNodes: [0,4],\n  repeatNodeCount: 1,\n  tokenData: \",q~Rars!Wst$^tu${xy%gyz%x}!O&e!O!P'k!Q!R'k!R!['p![!]'x!a!b&e!c!}(_!}#O+a#P#Q+a#T#](_#]#^+f#^#o(_~!ZZOr!Wrs!|s#O!W#O#P#R#P$Ip!W$Ip$Iq!|$Iq$Ir!|$Ir$Is!|$Is;'S!W;'S;=`$W<%lO!W~#RO!i~~#URO;'S!W;'S;=`#_;=`O!W~#b[Or!Wrs!|s#O!W#O#P#R#P$Ip!W$Ip$Iq!|$Iq$Ir!|$Ir$Is!|$Is;'S!W;'S;=`$W;=`<%l!W<%lO!W~$ZP;=`<%l!W~$aPst$d~$iS!p~OY$dZ;'S$d;'S;=`$u<%lO$d~$xP;=`<%l$d~%OQ!c!}%U#T#o%U~%ZS!m~!Q![%U!c!}%U#R#S%U#T#o%U~%lS!o~|}%x!O!P%x![!]%}!]!^&Y~%}O!o~~&SQ!o~!O!P%x![!]%x~&_Q!o~|}%x!]!^%x~&j^S~qr&euv&evw&ez{&e{|&e}!O&e!Q![&e![!]'f!^!_&e!_!`&e!`!a&e!a!b&e!c!}&e#T#o&e~'kOS~~'pO!j~~'uP!j~!Q!['p~'{Q!_!`(R!`!a${~(UR!c!}%U!}#O${#T#o%U~(f`!k~S~qr(_uv(_vw(_z{(_{|(_}!O(_!Q![(_![!])h!^!_(_!_!`(_!`!a(_!a!b(_!c!}(_#T#b(_#b#c)o#c#o(_~)oO!l~S~~)va!k~S~qr(_uv(_vw(_wx*{z{(_{|(_}!O(_!Q![(_![!])h!^!_(_!_!`(_!`!a(_!a!b(_!c!}(_#T#b(_#b#c)o#c#o(_~+OP#h#i+R~+WP!k~#b#c+Z~+^Pwx*{~+fO!n~~+o`!k~!j~S~qr(_uv(_vw(_z{(_{|(_}!O(_!Q![(_![!])h!^!_(_!_!`(_!`!a(_!a!b(_!c!}(_#T#b(_#b#c)o#c#o(_\",\n  tokenizers: [0],\n  topRules: {\"Program\":[0,1]},\n  specialized: [{term: 4, get: (value) => spec_WeirdKW[value] || -1}],\n  tokenPrec: 222\n})\n\nexport default __parser\n// This file was generated by lezer-generator. You probably shouldn't edit it.\nexport const\n  Program = 1,\n  Word = 2,\n  Structure = 3,\n  WeirdKW = 4,\n  _if = 7,\n  _for = 8,\n  _while = 12,\n  endfor = 18,\n  endwhile = 20,\n  endlambda = 22,\n  end = 24,\n  Branch = 29,\n  _else = 32,\n  elif = 33,\n  body = 35,\n  _do = 36,\n  branch = 37,\n  then = 38,\n  _in = 39,\n  using = 40,\n  from = 43,\n  as = 44,\n  _with = 45,\n  given = 46,\n  has = 48,\n  does = 49,\n  on = 50,\n  Lambda = 52,\n  lambda = 53,\n  lam = 54,\n  String = 71,\n  Number = 72,\n  Element = 73,\n  Modifier = 74,\n  VariableThing = 75,\n  ListStuff = 76,\n  GroupStuff = 77,\n  Comment = 78\n","import { LRLanguage } from \"@codemirror/language\";\nimport { styleTags, tags } from \"@lezer/highlight\";\nimport parser from \"./vyxal-lit.grammar\";\nexport const vyxalLitLanguage = LRLanguage.define({\n    parser: parser.configure({\n        props: [\n            styleTags({\n                Structure: tags.controlKeyword,\n                Branch: tags.controlKeyword,\n                Lambda: tags.controlKeyword,\n                String: tags.string,\n                Number: tags.number,\n                Element: tags.keyword,\n                Modifier: tags.modifier,\n                VariableThing: tags.variableName,\n                ListStuff: tags.literal,\n                GroupStuff: tags.keyword,\n                Comment: tags.comment,\n            }),\n        ],\n    }),\n});\n","import { LanguageSupport } from \"@codemirror/language\";\nimport { elementAutocomplete, elementTooltip } from \"./common\";\nimport { vyxalLitLanguage } from \"../../../common/scripts/languages/vyxal-lit\";\nexport function vyxalLitCompletion(elementData) {\n    return vyxalLitLanguage.data.of({\n        autocomplete(context) {\n            return elementAutocomplete(elementData, context, true);\n        },\n    });\n}\nexport function vyxalLit(elementData) {\n    return new LanguageSupport(vyxalLitLanguage, [vyxalLitCompletion(elementData), elementTooltip(elementData, true)]);\n}\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { useCallback, useContext, useMemo, useRef, useState } from \"react\";\nimport ReactCodeMirror, { keymap, Prec } from \"@uiw/react-codemirror\";\nimport { minimalSetup } from \"codemirror\";\nimport { vscodeDark } from \"@uiw/codemirror-theme-vscode\";\nimport { vyxal } from \"./extensions/vyxal/vyxal-extensions\";\nimport { autocompletion } from \"@codemirror/autocomplete\";\nimport { EditorView, highlightActiveLine, highlightActiveLineGutter, lineNumbers, showPanel } from \"@codemirror/view\";\nimport { Theme } from \"./util/misc\";\nimport { UtilWorker } from \"./util/util-worker\";\nimport { githubLight } from \"@uiw/codemirror-theme-github\";\nimport { ElementDataContext } from \"./util/element-data\";\nimport { vyxalLit } from \"./extensions/vyxal-lit-extensions\";\nimport { createPortal } from \"react-dom\";\nimport { ErrorBoundary } from \"react-error-boundary\";\nimport { Button, Stack } from \"react-bootstrap\";\nconst EXTENSIONS = [\n    Prec.high(keymap.of([\n        {\n            key: \"Ctrl-Enter\",\n            run(view) {\n                if (view.state.doc.length <= 0) {\n                    return false;\n                }\n                window.dispatchEvent(new Event(\"run-vyxal\")); // dubious\n                return true;\n            },\n            preventDefault: true,\n        },\n    ])),\n    minimalSetup,\n    autocompletion(),\n    lineNumbers(),\n    highlightActiveLine(),\n    highlightActiveLineGutter(),\n    EditorView.theme({\n        \"&\": { height: \"100%\" },\n        \"&.cm-focused\": { outline: \"none\" },\n        \".cm-scroller\": { overflow: \"auto\" },\n        \".cm-tooltip\": { \"z-index\": \"300 !important\" },\n    }),\n];\nconst util = new UtilWorker();\nconst THEMES = {\n    [Theme.Dark]: vscodeDark,\n    [Theme.Light]: githubLight,\n};\nfunction EditorError({ error, resetErrorBoundary }) {\n    return _jsxs(Stack, { direction: \"vertical\", className: \"bg-danger-subtle p-2 position-absolute\", children: [_jsxs(\"h3\", { className: \"text-danger\", children: [_jsx(\"i\", { className: \"bi bi-x-circle\" }), \" An error occured\"] }), _jsx(Button, { variant: \"danger\", onClick: resetErrorBoundary, children: \"Reset editor\" }), error.toString(), _jsx(\"div\", { children: error.stack })] });\n}\nexport default function Editor({ code, ratio, children, setCode, theme, literate, claimFocus, autoFocus }) {\n    const elementData = useContext(ElementDataContext);\n    const editorRef = useRef(null);\n    const onChange = useCallback((code) => {\n        setCode(code);\n    }, []);\n    const [headerDom, setHeaderDom] = useState(null);\n    const header = useMemo(() => showPanel.of(() => {\n        const dom = document.createElement(\"div\");\n        dom.classList.add(\"p-1\");\n        setHeaderDom(dom);\n        return { dom, top: true };\n    }), []);\n    const focusChangeHandler = useMemo(() => EditorView.focusChangeEffect.of((state, focusing) => {\n        if (focusing && editorRef.current) {\n            claimFocus(editorRef.current);\n        }\n        return null;\n    }), []);\n    const extensions = useMemo(() => EXTENSIONS.concat(literate ? vyxalLit(elementData) : vyxal(util, elementData), header, focusChangeHandler), [literate]);\n    return _jsx(_Fragment, { children: _jsxs(ErrorBoundary, { FallbackComponent: EditorError, children: [_jsx(ReactCodeMirror, { basicSetup: false, theme: THEMES[theme], value: code, style: { height: ratio }, onChange: onChange, extensions: extensions, ref: editorRef, autoFocus: autoFocus }), headerDom !== null && createPortal(children, headerDom)] }) });\n}\n;\n"],"names":["KEYWORD","PREFIXED_KEYWORD","RegExp","source","elementCompletion","thing","literate","label","type","keywords","symbol","detail","name","info","container","document","createElement","root","render","ThingCard","dom","destroy","setTimeout","unmount","syncElementAutocomplete","context","word","matchBefore","text","trimStart","results","search","length","from","filter","options","map","result","item","boost","score","update","current","to","async","elementAutocomplete","elementData","sync","Promise","resolve","explicit","pos","elements","values","e","elementTooltip","view","node","state","hovered","doc","sliceString","modifiersByKeyword","modifiers","elementsByKeyword","get","syntax","has","undefined","create","card","shadow","deserialize","version","states","stateData","goto","nodeNames","maxTerm","skippedNodes","repeatNodeCount","tokenData","tokenizers","topRules","tokenPrec","vyxalLanguage","define","parser","configure","props","Digraph","function","propertyName","SugarTrigraph","macroName","SyntaxTrigraph","operator","StructureOpen","bracket","StructureClose","Modifier","modifier","VariableThing","variableName","String","string","SingleCharString","special","TwoCharString","number","TwoCharNumber","Branch","punctuation","ContextIndex","controlKeyword","Comment","comment","Element","keyword","theme","baseTheme","backgroundColor","display","matchingMark","mark","class","nonmatchingMark","EOFWidget","eq","toDOM","element","classList","add","textContent","eofWidget","widget","side","matchBrackets","position","tree","startNode","resolveInner","iter","cursorAt","depth","closer","matched","start","end","next","openers","iterate","enter","splice","pop","push","Error","highlight","bracketMatchingState","none","decorationSet","transaction","docChanged","selection","decorations","range","ranges","empty","match","head","set","provide","f","vyxalHover","util","makeStringTooltip","content","slice","toString","at","decompressed","decompress","innerHTML","appendChild","changes","touchesRange","newPos","mapPos","TrackDel","replaceChildren","vyxal","data","of","autocomplete","sugar","desugared","sugars","spec_WeirdKW","__proto__","if","for","while","endfor","endwhile","endlambda","else","elif","body","do","branch","then","in","using","as","with","given","does","on","lambda","lam","specialized","term","value","vyxalLitLanguage","Structure","Lambda","Number","ListStuff","literal","GroupStuff","vyxalLitCompletion","EXTENSIONS","high","key","run","window","dispatchEvent","Event","preventDefault","height","outline","overflow","THEMES","Dark","Light","EditorError","error","resetErrorBoundary","Stack","direction","className","children","Button","variant","onClick","stack","Editor","code","ratio","setCode","claimFocus","autoFocus","useContext","editorRef","useRef","onChange","useCallback","headerDom","setHeaderDom","useState","header","useMemo","top","focusChangeHandler","focusChangeEffect","focusing","extensions","concat","vyxalLit","FallbackComponent","basicSetup","style","ref","createPortal"],"sourceRoot":""}