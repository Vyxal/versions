(self.webpackChunkvyxal_github_io=self.webpackChunkvyxal_github_io||[]).push([[422],{1419:(e,t,i)=>{i.d(t,{$w:()=>w});var s=i(1371),o=i(6585),n=i(3748);class a{constructor(e,t,i){this.from=e,this.to=t,this.diagnostic=i}}class l{constructor(e,t,i){this.diagnostics=e,this.panel=t,this.selected=i}static init(e,t,i){let o=e,n=i.facet(x).markerFilter;n&&(o=n(o,i));let a=s.NZ.set(o.map((e=>e.from==e.to||e.from==e.to-1&&i.doc.lineAt(e.from).to==e.from?s.NZ.widget({widget:new C(e),diagnostic:e}).range(e.from):s.NZ.mark({attributes:{class:"cm-lintRange cm-lintRange-"+e.severity+(e.markClass?" "+e.markClass:"")},diagnostic:e}).range(e.from,e.to))),!0);return new l(a,t,r(a))}}function r(e,t=null,i=0){let s=null;return e.between(i,1e9,((e,i,{spec:o})=>{if(!t||o.diagnostic==t)return s=new a(e,i,o.diagnostic),!1})),s}function c(e,t){let i=t.pos,s=t.end||i,o=e.state.facet(x).hideOn(e,i,s);if(null!=o)return o;let n=e.startState.doc.lineAt(t.pos);return!(!e.effects.some((e=>e.is(h)))&&!e.changes.touchesRange(n.from,Math.max(n.to,s)))}function d(e,t){return e.field(f,!1)?t:t.concat(o.Pe.appendConfig.of(L))}const h=o.Pe.define(),m=o.Pe.define(),g=o.Pe.define(),f=o.sU.define({create:()=>new l(s.NZ.none,null,null),update(e,t){if(t.docChanged&&e.diagnostics.size){let i=e.diagnostics.map(t.changes),s=null,o=e.panel;if(e.selected){let o=t.changes.mapPos(e.selected.from,1);s=r(i,e.selected.diagnostic,o)||r(i,null,o)}!i.size&&o&&t.state.facet(x).autoPanel&&(o=null),e=new l(i,o,s)}for(let i of t.effects)if(i.is(h)){let s=t.state.facet(x).autoPanel?i.value.length?R.open:null:e.panel;e=l.init(i.value,s,t.state)}else i.is(m)?e=new l(e.diagnostics,i.value?R.open:null,e.selected):i.is(g)&&(e=new l(e.diagnostics,e.panel,i.value));return e},provide:e=>[s.S7.from(e,(e=>e.panel)),s.Lz.decorations.from(e,(e=>e.diagnostics))]});const u=s.NZ.mark({class:"cm-lintRange cm-lintRange-active"});function p(e,t,i){let{diagnostics:s}=e.state.field(f),o=[],n=2e8,a=0;s.between(t-(i<0?1:0),t+(i>0?1:0),((e,s,{spec:l})=>{t>=e&&t<=s&&(e==s||(t>e||i>0)&&(t<s||i<0))&&(o.push(l.diagnostic),n=Math.min(e,n),a=Math.max(s,a))}));let l=e.state.facet(x).tooltipFilter;return l&&(o=l(o,e.state)),o.length?{pos:n,end:a,above:e.state.doc.lineAt(n).to<a,create:()=>({dom:b(e,o)})}:null}function b(e,t){return(0,n.A)("ul",{class:"cm-tooltip-lint"},t.map((t=>y(e,t,!1))))}const v=e=>{let t=e.state.field(f,!1);return!(!t||!t.panel)&&(e.dispatch({effects:m.of(!1)}),!0)},w=[{key:"Mod-Shift-m",run:e=>{let t=e.state.field(f,!1);t&&t.panel||e.dispatch({effects:d(e.state,[m.of(!0)])});let i=(0,s.ld)(e,R.open);return i&&i.dom.querySelector(".cm-panel-lint ul").focus(),!0},preventDefault:!0},{key:"F8",run:e=>{let t=e.state.field(f,!1);if(!t)return!1;let i=e.state.selection.main,s=t.diagnostics.iter(i.to+1);return!(!s.value&&(s=t.diagnostics.iter(0),!s.value||s.from==i.from&&s.to==i.to))&&(e.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0}),!0)}}],x=o.sj.define({combine:e=>Object.assign({sources:e.map((e=>e.source)).filter((e=>null!=e))},(0,o.QR)(e.map((e=>e.config)),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,t)=>e?t?i=>e(i)||t(i):e:t}))});function k(e){let t=[];if(e)e:for(let{name:i}of e){for(let e=0;e<i.length;e++){let s=i[e];if(/[a-zA-Z]/.test(s)&&!t.some((e=>e.toLowerCase()==s.toLowerCase()))){t.push(s);continue e}}t.push("")}return t}function y(e,t,i){var s;let o=i?k(t.actions):[];return(0,n.A)("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},(0,n.A)("span",{class:"cm-diagnosticText"},t.renderMessage?t.renderMessage(e):t.message),null===(s=t.actions)||void 0===s?void 0:s.map(((i,s)=>{let a=!1,l=s=>{if(s.preventDefault(),a)return;a=!0;let o=r(e.state.field(f).diagnostics,t);o&&i.apply(e,o.from,o.to)},{name:c}=i,d=o[s]?c.indexOf(o[s]):-1,h=d<0?c:[c.slice(0,d),(0,n.A)("u",c.slice(d,d+1)),c.slice(d+1)];return(0,n.A)("button",{type:"button",class:"cm-diagnosticAction",onclick:l,onmousedown:l,"aria-label":` Action: ${c}${d<0?"":` (access key "${o[s]})"`}.`},h)})),t.source&&(0,n.A)("div",{class:"cm-diagnosticSource"},t.source))}class C extends s.xO{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return(0,n.A)("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class A{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(4294967295*Math.random()).toString(16),this.dom=y(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class R{constructor(e){this.view=e,this.items=[];this.list=(0,n.A)("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t=>{if(27==t.keyCode)v(this.view),this.view.focus();else if(38==t.keyCode||33==t.keyCode)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(40==t.keyCode||34==t.keyCode)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(36==t.keyCode)this.moveSelection(0);else if(35==t.keyCode)this.moveSelection(this.items.length-1);else if(13==t.keyCode)this.view.focus();else{if(!(t.keyCode>=65&&t.keyCode<=90&&this.selectedIndex>=0))return;{let{diagnostic:i}=this.items[this.selectedIndex],s=k(i.actions);for(let o=0;o<s.length;o++)if(s[o].toUpperCase().charCodeAt(0)==t.keyCode){let t=r(this.view.state.field(f).diagnostics,i);t&&i.actions[o].apply(e,t.from,t.to)}}}t.preventDefault()},onclick:e=>{for(let t=0;t<this.items.length;t++)this.items[t].dom.contains(e.target)&&this.moveSelection(t)}}),this.dom=(0,n.A)("div",{class:"cm-panel-lint"},this.list,(0,n.A)("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>v(this.view)},"Ã—")),this.update()}get selectedIndex(){let e=this.view.state.field(f).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(f),i=0,s=!1,o=null;for(e.between(0,this.view.state.doc.length,((e,n,{spec:a})=>{let l,r=-1;for(let e=i;e<this.items.length;e++)if(this.items[e].diagnostic==a.diagnostic){r=e;break}r<0?(l=new A(this.view,a.diagnostic),this.items.splice(i,0,l),s=!0):(l=this.items[r],r>i&&(this.items.splice(i,r-i),s=!0)),t&&l.diagnostic==t.diagnostic?l.dom.hasAttribute("aria-selected")||(l.dom.setAttribute("aria-selected","true"),o=l):l.dom.hasAttribute("aria-selected")&&l.dom.removeAttribute("aria-selected"),i++}));i<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)s=!0,this.items.pop();0==this.items.length&&(this.items.push(new A(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),s=!0),o?(this.list.setAttribute("aria-activedescendant",o.id),this.view.requestMeasure({key:this,read:()=>({sel:o.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:e,panel:t})=>{let i=t.height/this.list.offsetHeight;e.top<t.top?this.list.scrollTop-=(t.top-e.top)/i:e.bottom>t.bottom&&(this.list.scrollTop+=(e.bottom-t.bottom)/i)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),s&&this.sync()}sync(){let e=this.list.firstChild;function t(){let t=e;e=t.nextSibling,t.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;e!=i.dom;)t();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=r(this.view.state.field(f).diagnostics,this.items[e].diagnostic);t&&this.view.dispatch({selection:{anchor:t.from,head:t.to},scrollIntoView:!0,effects:g.of(t)})}static open(e){return new R(e)}}function S(e,t='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${t}>${encodeURIComponent(e)}</svg>')`}function I(e){return S(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${e}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const P=s.Lz.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:I("#d11")},".cm-lintRange-warning":{backgroundImage:I("orange")},".cm-lintRange-info":{backgroundImage:I("#999")},".cm-lintRange-hint":{backgroundImage:I("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});s.wJ;const L=[f,s.Lz.decorations.compute([f],(e=>{let{selected:t,panel:i}=e.field(f);return t&&i&&t.from!=t.to?s.NZ.set([u.range(t.from,t.to)]):s.NZ.none})),(0,s.Ux)(p,{hideOn:c}),P]}}]);
//# sourceMappingURL=../../maps/@codemirror-lint-dist-index.c31538b0.js.map